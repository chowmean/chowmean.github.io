



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Creating a CLI application - Python Training for Devops.</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Python Training for Devops." class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Python Training for Devops.
            </span>
            <span class="md-header-nav__topic">
              
                Creating a CLI application
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Python Training for Devops." class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Python Training for Devops.
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../syntax/" title="Python Syntax" class="md-nav__link">
      Python Syntax
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mem/" title="Memory Management" class="md-nav__link">
      Memory Management
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gil/" title="Global Interpreter Lock" class="md-nav__link">
      Global Interpreter Lock
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../oops/" title="Object Oriented Programming" class="md-nav__link">
      Object Oriented Programming
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tooling/" title="Basic Tooling for Python" class="md-nav__link">
      Basic Tooling for Python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../best_practices/" title="Best Practices for programming and python" class="md-nav__link">
      Best Practices for programming and python
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Creating a CLI application" class="md-nav__link md-nav__link--active">
      Creating a CLI application
    </a>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../logging/" title="Logging in application" class="md-nav__link">
      Logging in application
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../internals/" title="Python internals" class="md-nav__link">
      Python internals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flask/" title="Flask" class="md-nav__link">
      Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flaskdb/" title="Python With Mysql" class="md-nav__link">
      Python With Mysql
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flaskandorm/" title="Flask and ORM" class="md-nav__link">
      Flask and ORM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../metrics/" title="Exposing metrics with python" class="md-nav__link">
      Exposing metrics with python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../package/" title="Creating a python package" class="md-nav__link">
      Creating a python package
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../app/" title="Lets create and application" class="md-nav__link">
      Lets create and application
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iterators/" title="Iterators and how to create one" class="md-nav__link">
      Iterators and how to create one
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h2 id="introduction">Introduction</h2>
<p>In this part we will be creating a cli application using a well known framework called Click. </p>
<h2 id="what-you-need-to-start-this">What you need to start this?</h2>
<p>Basic knowledge of python syntax loops, how to use packages and how to run python program. Knowledge of cli app will be a good addition. </p>
<h2 id="click-package">Click package</h2>
<p>Click is a Python package for creating beautiful command line interfaces in a composable way with as little code as necessary. It’s the “Command Line Interface Creation Kit”. It’s highly configurable but comes with sensible defaults out of the box.</p>
<p>Click adds functionality like help by default which is very useful in case of cli apps. Functionality like below</p>
<pre>
(venv) $chowmean@chowmean-MACH-WX9:$ python hello_click.py help
Usage: hello_click.py [OPTIONS]
Try "hello_click.py --help" for help.

Error: Got unexpected extra argument (help)
(venv) $chowmean@chowmean-MACH-WX9:$ python hello_click.py --help
Usage: hello_click.py [OPTIONS]

  Simple program that greets NAME for a total of COUNT times.

Options:
  --help  Show this message and exit.
(venv) $chowmean@chowmean-MACH-WX9:$ 
</pre>

<h2 id="lets-code">Lets code</h2>
<p>Create a directory for your project. Then create a requirements.txt file in your directory. After that initialize an empty env for you python project and then run pip install to install the required packages. Here package will be click so put click in your requirements file. All of this is below</p>
<pre>
mkdir project_name
cd project_name && touch requirements.txt
virtualenv venv
source venv/bin/activate
echo "click" >> requirements.txt
pip install -r requirements.txt
</pre>

<p>Our project directory is ready create a file with any name and start writing the code below.</p>
<p>Here we will be creating a very basic cli app which says hello. </p>
<pre>
import click
@click.command()
def hello():
    """Simple program that greets NAME for a total of COUNT times."""
    click.echo('Hello')

if __name__ == '__main__':
    hello()

</pre>

<p>Save the above snippet in file called hello.py
Run this using python hello.py and you will see hello as output. </p>
<h3 id="arguments-and-options">Arguments and options</h3>
<p>Lets first distinguish between these two. </p>
<p><em>Options</em> are the values that you can provide to your program through CLI. </p>
<p><em>Arguments</em>  work similarly to options but are positional. They also only support a subset of the features of options due to their syntactical nature. </p>
<p>Arguments cannot do anything more than options so we will have a look at options in detail</p>
<h4 id="options">Options</h4>
<p>For taking options click provide a very easy options. Have a look at code below</p>
<pre>
import click
@click.command()
@click.option('--name', prompt='Your name',
              help='The person to greet.')
def hello(name):
    for x in range(10):
        click.echo('Hello %s!' % name)

if __name__ == '__main__':
    hello()
</pre>

<p>Here you can take your name as CLI argument and then this program will print hello your_name. Run this command to run it.</p>
<pre>
python hello.py --name=conan
</pre>

<p>Now you can divide options in two type required and optional ones. 
For that you only have to pass <em>required=True</em> and that option will be mandatory</p>
<pre>
import click
@click.command()
@click.option('--name', prompt='Your name',
              help='The person to greet.', required=True)
@click.option('--age', prompt='Your age',
              help="The person's age.", default=35)
def hello(name, age):
    for x in range(1):
        click.echo('%s is %s years old!!!' % (name,age))

if __name__ == '__main__':
    hello()
</pre>

<p>In above code now name is a mandatory option. </p>
<h3 id="prompts">Prompts</h3>
<p>Prompts are a way to take user in input at the run time. These are useful when you want to enter some password and don't want it to be recorded in history command. </p>
<p>There are two types of prompts here. </p>
<h4 id="input-prompts">Input prompts.</h4>
<p>Input prompts are used for taking inputs from users. Look at the example below
<pre>
value = click.prompt('Please enter your nanme', type=string)
</pre></p>
<h4 id="confirmation-prompts">Confirmation prompts.</h4>
<p>Confirmation prompts are for confirming if you want to continue. </p>
<pre>
import click
@click.command()
def hello():
    if click.confirm('Do you want to continue?'):
        click.echo('user entered yes')
    else:
        click.echo('user entered No')

if __name__ == '__main__':
    hello()
</pre>

<h1 id="examples">Examples:</h1>
<p>this example explains about hiding the prompted value(useful in case of  passwords)
<pre>
import click
@click.command()
@click.option('--password', prompt=True, hide_input=True,
              confirmation_prompt=True)
def encrypt(password):
    click.echo('Encrypting password to %s' % password.encode('rot13'))
if <strong>name</strong> == '<strong>main</strong>':
    encrypt()
</pre></p>
<p>You can give option <code>abort=True</code>. If you want to abort on not confirming. 
<pre>
import click
@click.command()
def hello():
    if click.confirm('Do you want to continue?', default=True, abort=True):
        click.echo('user entered yes')
    else:
        click.echo('user entered No')
    print "!!!Yahhoo... user allowed me to get execute by entering Yes" 
if <strong>name</strong> == '<strong>main</strong>':
    hello()
</pre></p>
<h2 id="click-application-to-pull-repos">Click application to pull repos</h2>
<p>Here we will build a very small application to get all the public github repos of any users. </p>
<p>Lets first plan how we will do this. So there will be only two steps. One where we ask for the username of the user to search repos for and next is getting the repo and printing it. </p>
<p>For first part we will get username like below</p>
<pre>
import click
@click.command()
@click.option('--username', prompt='Github username',
              help='Github username to get repo details.')

def get_projects(username):
    return username

if __name__ == '__main__':
    get_projects()
</pre>

<p>Here we got the input from user to get the username. Now we have to get the details of its repository. </p>
<p>For that we need to make an api call to open githib apis. For making http calls in python we use a very famous library called requests. </p>
<p>Look at the code below to understand how requests library works.</p>
<pre>
import requests
a = requests.get("www.google.com")
print(a.content)
</pre>

<p>As simple as this. It supports all the options that are there in http calls like headers, methods etc. We will use this library to make a call to github api. </p>
<p>Look at the code below</p>
<pre>
import click
import requests
@click.command()
@click.option('--username', prompt='Github username',
              help='Github username to get repo details.')

def get_projects(username):
    a = requests.get("https://api.github.com/users/"+username+"/repos")
    print(a.content)

if __name__ == '__main__':
    get_projects()

</pre>

<p>You got the list of repository but they have lot more data and they need to be in understood by program as object. Right now they are in json format. For handling json we have a library called json in python</p>
<p>Lets see that..</p>
<pre>
import click
import requests
import json
@click.command()
@click.option('--username', prompt='Github username',
              help='Github username to get repo details.')

def get_projects(username):
    a = requests.get("https://api.github.com/users/"+username+"/repos")
    data = json.loads(a.content)
    for item in data:
        print item['name']

if __name__ == '__main__':
    get_projects()

</pre>

<p>This will print the names of all the repos </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../best_practices/" title="Best Practices for programming and python" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Best Practices for programming and python
              </span>
            </div>
          </a>
        
        
          <a href="../logging/" title="Logging in application" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Logging in application
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>