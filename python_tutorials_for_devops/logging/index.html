



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Logging in application - Python Training for Devops.</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#logging" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Python Training for Devops." class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Python Training for Devops.
            </span>
            <span class="md-header-nav__topic">
              
                Logging in application
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Python Training for Devops." class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Python Training for Devops.
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../syntax/" title="Python Syntax" class="md-nav__link">
      Python Syntax
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mem/" title="Memory Management" class="md-nav__link">
      Memory Management
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gil/" title="Global Interpreter Lock" class="md-nav__link">
      Global Interpreter Lock
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../oops/" title="Object Oriented Programming" class="md-nav__link">
      Object Oriented Programming
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tooling/" title="Basic Tooling for Python" class="md-nav__link">
      Basic Tooling for Python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../best_practices/" title="Best Practices for programming and python" class="md-nav__link">
      Best Practices for programming and python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cliapp/" title="Creating a CLI application" class="md-nav__link">
      Creating a CLI application
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Logging in application
      </label>
    
    <a href="./" title="Logging in application" class="md-nav__link md-nav__link--active">
      Logging in application
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configurations" title="Configurations" class="md-nav__link">
    Configurations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../internals/" title="Python internals" class="md-nav__link">
      Python internals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flask/" title="Flask" class="md-nav__link">
      Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flaskdb/" title="Python With Mysql" class="md-nav__link">
      Python With Mysql
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flaskandorm/" title="Flask and ORM" class="md-nav__link">
      Flask and ORM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../metrics/" title="Exposing metrics with python" class="md-nav__link">
      Exposing metrics with python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../package/" title="Creating a python package" class="md-nav__link">
      Creating a python package
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../app/" title="Lets create and application" class="md-nav__link">
      Lets create and application
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iterators/" title="Iterators and how to create one" class="md-nav__link">
      Iterators and how to create one
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../generators/" title="Generators" class="md-nav__link">
      Generators
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../threading/" title="Threading and Multiprocessing" class="md-nav__link">
      Threading and Multiprocessing
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configurations" title="Configurations" class="md-nav__link">
    Configurations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="logging">Logging</h1>
<p>In this section we will have a look how we can do logging in python applications. We will also have a look what we should and and what we should not log. 
Logging is important but extra logging can cause a lot of issue. Issues like latency, extra disk space usage etc. </p>
<p>For logging in python we use logging module of python. Have a look at the code below</p>
<pre>

import logging

logging.debug('This is a debug')
logging.info('This is an info')
logging.warning('This is a warning')
logging.error('This is an error')
logging.critical('This is a critical')
</pre>

<p>It is very basic to do logging in python.</p>
<h3 id="configurations">Configurations</h3>
<p>Below are few of the basic configs that will be useful for you. </p>
<p>level: Sets the log level</p>
<p>filename: This specifies the file.</p>
<p>filemode: If filename is given, the file is opened in this mode. The default is a, which means append.</p>
<p>format: This is the format of the log message.</p>
<p>Lets use this in our applications</p>
<pre>
import click
import requests
import json
import logging
logging.basicConfig(format='%(asctime)s - %(message)s', datefmt='%d-%b-%y %H:%M:%S', filename='app.logs', level=logging.DEBUG)

@click.command()
@click.option('--username', prompt='Github username',
                help='Github username to get repo details.')

def get_projects(username):
    logging.debug("Contacting github for repos.")
    a = requests.get("https://api.github.com/users/"+username+"/repos")
    logging.debug("Github data received.")
    data = json.loads(a.content)
    return data

if __name__ == '__main__':
    logging.debug("Initilizing application.")
    get_projects()
</pre>

<p>Now when you will run this you can see the logs in app.logs file. Now if you want these logging to be configurable you can simply get these as options like below.</p>
<pre>
import click
import requests
import json
import logging

log_levels={
    "warn": logging.WARNING,
    "info": logging.INFO,
    "error": logging.ERROR,
    "debug": logging.DEBUG,
    "critical": logging.CRITICAL
}



@click.command()
@click.option('--username', prompt='Github username', help='Github username to get repo details.')
@click.option('--logfile', prompt='Log file name', help='File to which log', default="app.logs")
@click.option('--loglevel', prompt='Log level', help='Log level to use.', default="warn")
def get_projects(username, logfile, loglevel):
    logging.basicConfig(format='%(asctime)s - %(message)s', datefmt='%d-%b-%y %H:%M:%S', filename=logfile, level=log_levels[loglevel])
    logging.debug("Contacting github for repos.")
    a = requests.get("https://api.github.com/users/"+username+"/repos")
    logging.debug("Github data received.")
    data = json.loads(a.content)
    return data

if __name__ == '__main__':
    get_projects()
</pre>

<h1 id="rotating-logs">Rotating Logs:</h1>
<p>Python’s logging module has lots of options. In this article, we will looks at the logging module’s ability to create Rotating Logs. Python supports two types of rotating logs:
1) Rotate logs based on size (RotatingFileHandler)
2) Rotate the logs based on some time interval (TimedRotatingFileHandler)</p>
<h3 id="the-rotatingfilehandler">The RotatingFileHandler:</h3>
<p>It rotates the logs based on the size of the log file.
   We can specify the size with "maxBytes" parameter.</p>
<p>The handler will close the file and silently open a new one. If you pass in a number for the backupCount parameter, then it will append “.1”, “.2”, etcetera to the end of the log files. Let’s take a look at a simple example:
   <pre>
import logging
import time</p>
<p>from logging.handlers import RotatingFileHandler
def create_rotating_log(path):
    """
    Creates a rotating log based on size 
    """
    logger = logging.getLogger("Rotating Log")
    logger.setLevel(logging.INFO)
    handler = RotatingFileHandler(path, maxBytes=20, backupCount=5)
    logger.addHandler(handler) 
    for i in range(10):
        logger.info("This is test log line %s" % i)
        time.sleep(1.5)</p>
<p>if __name__ == "__main__":
    log_file = "test.log"
    create_rotating_log(log_file)
</pre></p>
<h4 id="understanding-above-code-in-steps">Understanding above code in steps:</h4>
<ol>
<li>we create a log file with a logging level of INFO.</li>
<li>Then we set up the handler to rotate the log whenever the log file is 20 bytes in length</li>
<li>we create a loop that will create 10 lines in our log file with a sleep in between each call to log.</li>
</ol>
<h3 id="the-timedrotatingfilehandler">The TimedRotatingFileHandler:</h3>
<p>The TimedRotatingFileHandler allows the developer to create a rotating log based on how much time has elapsed.
You can set it to rotate the log on the following time conditions:</p>
<ol>
<li>second (s)</li>
<li>minute (m)</li>
<li>hour (h)</li>
<li>day (d)</li>
<li>w0-w6 (weekday, 0=Monday)</li>
<li>midnight</li>
</ol>
<h3 id="example">Example:</h3>
<p><pre>
import logging
import time</p>
<p>from logging.handlers import TimedRotatingFileHandler</p>
<p>def create_timed_rotating_log(path):
    logger = logging.getLogger("Rotating Log")
    logger.setLevel(logging.INFO)
    handler = TimedRotatingFileHandler(path,
                                       when="m",
                                       interval=1,
                                       backupCount=5)
    logger.addHandler(handler)
    for i in range(6):
        logger.info("This is a test!")
        time.sleep(75)</p>
<p>if __name__ == "__main__":
    log_file = "timed_test.log"
    create_timed_rotating_log(log_file)
</pre></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../cliapp/" title="Creating a CLI application" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Creating a CLI application
              </span>
            </div>
          </a>
        
        
          <a href="../decorators/" title="Decorators" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Decorators
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>